"use strict";var exports=exports||{},typestate;(function(t){var n=function(){function t(t){this.fsm=t}return t.prototype.to=function(){for(var t=[],n=0;arguments.length>n;n++)t[n-0]=arguments[n];this.toStates=t,this.fsm.addTransitions(this)},t.prototype.toAny=function(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(t[i]);this.toStates=n,this.fsm.addTransitions(this)},t}();t.Transitions=n;var i=function(){function t(t,n,i){this.fsm=t,this.from=n,this.to=i}return t}();t.TransitionFunction=i;var r=function(){function t(){}return t}();t.HierarchicalStateMachine=r;var a=function(){function t(t){this._transitionFunctions=[],this._onCallbacks={},this._exitCallbacks={},this._enterCallbacks={},this._invalidTransitionCallback=null,this.currentState=t,this._startState=t}return t.prototype.addTransitions=function(t){var n=this;t.fromStates.forEach(function(r){t.toStates.forEach(function(t){r===t||n._validTransition(r,t)||n._transitionFunctions.push(new i(n,r,t))})})},t.prototype.on=function(t,n){var i=""+t;return this._onCallbacks[i]||(this._onCallbacks[i]=[]),this._onCallbacks[i].push(n),this},t.prototype.onEnter=function(t,n){var i=""+t;return this._enterCallbacks[i]||(this._enterCallbacks[i]=[]),this._enterCallbacks[i].push(n),this},t.prototype.onExit=function(t,n){var i=""+t;return this._exitCallbacks[i]||(this._exitCallbacks[i]=[]),this._exitCallbacks[i].push(n),this},t.prototype.onInvalidTransition=function(t){return this._invalidTransitionCallback||(this._invalidTransitionCallback=t),this},t.prototype.from=function(){for(var t=[],i=0;arguments.length>i;i++)t[i-0]=arguments[i];var r=new n(this);return r.fromStates=t,r},t.prototype.fromAny=function(t){var i=[];for(var r in t)t.hasOwnProperty(r)&&i.push(t[r]);var a=new n(this);return a.fromStates=i,a},t.prototype._validTransition=function(t,n){return this._transitionFunctions.some(function(i){return i.from===t&&i.to===n})},t.prototype.canGo=function(t){return this.currentState===t||this._validTransition(this.currentState,t)},t.prototype.go=function(t){if(this.canGo(t))this._transitionTo(t);else if(!this._invalidTransitionCallback||!this._invalidTransitionCallback(this.currentState,t))throw Error("Error no transition function exists from state "+(""+this.currentState)+" to "+(""+t))},t.prototype.onTransition=function(){},t.prototype.reset=function(){this.currentState=this._startState},t.prototype.is=function(t){return this.currentState===t},t.prototype._transitionTo=function(t){var n=this;this._exitCallbacks[""+this.currentState]||(this._exitCallbacks[""+this.currentState]=[]),this._enterCallbacks[""+t]||(this._enterCallbacks[""+t]=[]),this._onCallbacks[""+t]||(this._onCallbacks[""+t]=[]);var i=this._exitCallbacks[""+this.currentState].reduce(function(i,r){return i&&r.call(n,t)},!0),r=this._enterCallbacks[""+t].reduce(function(t,i){return t&&i.call(n,n.currentState)},!0);if(i&&r){var a=this.currentState;this.currentState=t,this._onCallbacks[""+this.currentState].forEach(function(t){t.call(n,a)}),this.onTransition(a,t)}},t}();t.FiniteStateMachine=a})(typestate=exports.typestate||(exports.typestate={})),exports.TypeState=typestate;var TypeState=typestate;